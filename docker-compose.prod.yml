services:
    backend:
        image: 'backend-prod'
        build:
            context: .
            dockerfile: ./Dockerfile.prod
            target: backend-runner
            args:
                APP: backend
                WS_PORT: ${WS_PORT}
        expose:
            - ${WS_PORT}
        environment:
            - WS_PORT=${WS_PORT}
        restart: unless-stopped

    frontend:
        image: 'frontend-prod'
        build:
            context: .
            dockerfile: ./Dockerfile.prod
            target: frontend-runner
            args:
                APP: frontend
                WS_PORT: ${WS_PORT}
        ports:
            - 80:80
        depends_on:
            - backend
        restart: unless-stopped
